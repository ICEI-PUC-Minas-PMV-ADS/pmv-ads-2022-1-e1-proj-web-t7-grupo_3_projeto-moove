<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
        integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/dadd5e2854.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="css/info-carro.css">
    <link rel="stylesheet" href="css/cadastrarCarro.css">
    <script src="login.js"></script>
    <script src="cadastroCarro.js"></script>
    <style>
        header nav li#btn-login-out .dropdown-menu {
            background: rgba(0, 0, 0, .5);
        
        }

        header nav li#btn-login-out .dropdown-item {
            background: rgba(0, 0, 0, 0);
            color: #ffc107;
        }
    </style>
    <title>Moove</title>
    <script>
        // Verifica se o usuário já esta logado e se negativo, redireciona para tela de login        
        // if (!usuarioCorrente.login) {
        //     window.location.href = LOGIN_URL;
        // }

        function initPage() {

            debugger
            // Associa a função de logout ao botão
            //document.getElementById('btn_logout').addEventListener('click', logoutUser);

            // Informa o nome do usuário logado

            
            if (typeof usuarioCorrente.nome != "undefined") {
                document.getElementById('btn-login-out').innerHTML = `
                    <div class="dropdown">
                        <a class="btn btn-outline-warning dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-expanded="false">
                            <span id="nomeUsuario">
                        </a>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a onclick="logoutUser();" class="dropdown-item" href="#">Logout</a>
                                  
                        </div>
                    </div>
                `;
                document.getElementById('nomeUsuario').innerHTML = usuarioCorrente.nome;
                document.getElementById('cadastrarCarro').hidden = false;
            }
            else {
                document.getElementById('cadastrarCarro').hidden = true;
                document.getElementById('nomeUsuario').innerHTML = 'Logar';
                alert("Você precisa estar logado para cadastrar um carro")
                window.location.href = "index.html"
            }

        }
        function  verificarLogadoCadastro()
        {
            debugger
            if (typeof usuarioCorrente.nome == "undefined") 
            {
                alert("Favor logar");
                window.location.href = 'login.html';
            }
            else
                window.location.href = 'cadastroCarro.html';
            
            
        }
        window.addEventListener('load', initPage);
    </script>
</head>

<body onload="init()">

    <header>
        <nav class="navbar navbar-expand-md navbar-light fixed-top navbar-transparente">
            <div class="container">


                <a href="index.html" class="navbar-brand">
                    <img src="img/logos.png" width="142px">
                </a>

                <button class="navbar-toggler" data-toggle="collapse" data-target="#nav-principal">
                    <i class="fas fas-bars"></i>
                </button>

                <div class="collapse navbar-collapse" id="nav-principal">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="lista_carro.html" class="nav-link">Carros Disponíveis</a>
                        </li>
                        <li class="nav-item">
                            <a href="index.html#planos" class="nav-link">Sobre a Moove</a>
                        </li>
                        <li class="nav-item">
                            <a href="index.html#depoimento" class="nav-link">Avaliações</a>
                        </li>
                        <li class="nav-item">
                            <a href="cadastrarCarro.html" id="cadastrarCarro" class="nav-link">Cadastre seu Carro</a>
                        </li>
                        <!-- <li class="nav-item">
                                <a href="" class="nav-link" id="nomeUsuario">Perfil Usuário</a>
                            </li> -->
                        <li class="nav-item divisor"></li>
                        <li id="btn-login-out" class="nav-item">
                            <a href="login.html" class="btn btn-outline-warning ml-4"><span id="nomeUsuario"></span></a>
                        </li>
                    </ul>
                </div>

            </div>
        </nav>
    </header>
    <!--fim cabeçalho-->

    <section id="home">
        <form id="form-carro">
            <div class="form-group row">
                <div class="col-sm-4">
                    <label for="inputId">Descricao</label>
                    <input type="text" class="form-control" id="inputDescricao" placeholder="Descrição">
                </div>
                <div class="col-sm-8">
                    <label for="inputNome">Nome (*)</label>
                    <input type="text" class="form-control" id="inputNome" required placeholder="Informe o nome do contato">
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-5">
                    <label for="inputTelefone">Kilometragem (*)</label>
                    <input type="number" class="form-control" id="inputKilometragem" required placeholder="Kilometragem">
                </div>
                <div class="col-sm-7">
                    <label for="inputEmail">Lugares (*)</label>
                    <input type="number" class="form-control" id="inputLugares" required placeholder="Informe a quantidade de lugares">
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-6">
                    <label for="inputCidade">Motor</label>
                    <input type="text" class="form-control" id="inputMotor" placeholder="Informe o motor" >
                </div>
                <div class="col-sm-6">
                    <label for="inputCategoria">Categoria</label>
                    <input type="text" class="form-control" id="inputCategoria" required placeholder="Informe a categoria do carro">
                </div>
            </div>
            <div class="form-group row">    
                <div class="col-sm-12">
                    <label for="inputSite">Ano</label>
                    <input type="number" class="form-control" id="inputAno" required placeholder="Informe o Ano do Carro">
                </div>
                <div class="col-sm-12">
                    <label for="inputSite">Flex:</label>
                    <br>
                    <label id="check" for="inputSite">Sim</label>
                    <input type="radio" name="flex"  value="true"/>
                    <label id="check" for="inputSite">Não</label>
                    <input type="radio" name="flex"  value="false"/>
                </div>
            </div>
            <div class="form-group row">    
                <div class="col-sm-12">
                    <label for="inputSite">Cor</label>
                    <input type="text" class="form-control" id="inputCor" required placeholder="Informe a cor do carro">
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-4">
                    <small>(*) Campos obrigatórios</small>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-12">
                    <input type="button" class="btn btn-success" id="btnInsert" value="Inserir">
                    <input type="button" class="btn btn-secondary" id="btnClear" value="Limpar Formulario">
                    <a href="lista_carro.html"><input type="button" class="btn btn-warning" id="btnClear" value="Carros Disponiveis"></a>
                </div>
            </div>
        </form>
    </section>
    <!--fim home-->


    <footer>
        <div class="container">
            <div class="row">

                <div class="col-md-2 d-none d-md-block p-1">
                    <img src="img/logos.png" width="100">
                </div>
                <div class="col-md-10" >
                    <ul>
                        <li><a href="">
                                <img src="img/facebook.png">
                            </a></li>
                        <li><a href="">
                                <img src="img/twitter.png">
                            </a></li>
                        <li><a href="">
                                <img src="img/instagram.png">
                            </a></li>
                    </ul>
                </div>

            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF"
        crossorigin="anonymous"></script>

    <script>

        function init() {
            // Adiciona funções para tratar os eventos 
            $("#btnInsert").click(function () {
                debugger
                // Verfica se o formulário está preenchido corretamente
                if (!$('#form-carro')[0].checkValidity()) {
                    alert("Preencha o formulário corretamente.");
                    return;
                }

                // Obtem os valores dos campos do formulário
                let campoNome = $("#inputNome").val();
                let campoFlex = document.querySelector('input[name="flex"]:checked').value;
                let campoDescricao = $("#inputDescricao").val();
                let campoKilometragem = $('#inputKilometragem').val();
                let campoLugares = $("#inputLugares").val();
                let campoMotor = $('#inputMotor').val();
                let campoCategoria = $('#inputCategoria').val();
                let campoAno = $('#inputAno').val();
                let campoCor = $('#inputCor').val();
                let carro = { 
                    nomeCarro: campoNome, 
                    flex: campoFlex,
                    descricao: campoDescricao, 
                    km: campoKilometragem, 
                    lugares: campoLugares, 
                    motor: campoMotor,
                    categoria: campoCategoria,
                    ano: campoAno,
                    cor: campoCor };


                var retorno = insertCarro(carro);
                
                if(retorno)
                {
                    alert("Carro Inserido com sucesso")
                    window.location.href = "lista_carro.html"
                }
            
                // Limpa o formulario
                $("#form-carro")[0].reset();
            });

            // Intercepta o click do botão Listar Contatos
            $("#btnClear").click(function () {
                $("#form-carro")[0].reset();
            });
        }

    </script>


</body>

</html>